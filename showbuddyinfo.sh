#!/bin/sh

echo "/proc/buddyinfo:"

awk '{
    sum = $5 * 2**0 * 4096 + \
        $6 * 2**1 * 4096 + \
        $7 * 2**2 * 4096 + \
        $8 * 2**3 * 4096 + \
        $9 * 2**4 * 4096 + \
        $10 * 2**5 * 4096 + \
        $11 * 2**6 * 4096 + \
        $12 * 2**7 * 4096 + \
        $13 * 2**8 * 4096 + \
        $14 * 2**9 * 4096 + \
        $15 * 2**10 * 4096
    printf "%7.2f MiB ", sum / 1024 / 1024

    printf "%5s %8s %8s %8s %8s %8s %8s %8s %8s %8s %8s %8s\n", $4, $5 "*4K", $6 "*8K", $7 "*16K", $8 "*32K", $9 "*64K", $10 "*128K", $11 "*256K", $12 "*512K", $13 "*1M", $14 "*2M", $15 "*4M"
}' /proc/buddyinfo 

echo
